(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))u(i);new MutationObserver(i=>{for(const f of i)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function l(i){const f={};return i.integrity&&(f.integrity=i.integrity),i.referrerPolicy&&(f.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?f.credentials="include":i.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(i){if(i.ep)return;i.ep=!0;const f=l(i);fetch(i.href,f)}})();function se(o){if(o.__esModule)return o;var a=o.default;if(typeof a=="function"){var l=function u(){return this instanceof u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};l.prototype=a.prototype}else l={};return Object.defineProperty(l,"__esModule",{value:!0}),Object.keys(o).forEach(function(u){var i=Object.getOwnPropertyDescriptor(o,u);Object.defineProperty(l,u,i.get?i:{enumerable:!0,get:function(){return o[u]}})}),l}var ae={exports:{}};(function(o){var a=function(l){var u=Object.prototype,i=u.hasOwnProperty,f=Object.defineProperty||function(t,e,r){t[e]=r.value},m,v=typeof Symbol=="function"?Symbol:{},h=v.iterator||"@@iterator",O=v.asyncIterator||"@@asyncIterator",C=v.toStringTag||"@@toStringTag";function b(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{b({},"")}catch{b=function(e,r,c){return e[r]=c}}function M(t,e,r,c){var n=e&&e.prototype instanceof G?e:G,p=Object.create(n.prototype),E=new g(c||[]);return f(p,"_invoke",{value:Z(t,r,E)}),p}l.wrap=M;function S(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(c){return{type:"throw",arg:c}}}var R="suspendedStart",W="suspendedYield",$="executing",N="completed",y={};function G(){}function I(){}function k(){}var z={};b(z,h,function(){return this});var x=Object.getPrototypeOf,U=x&&x(x(w([])));U&&U!==u&&i.call(U,h)&&(z=U);var _=k.prototype=G.prototype=Object.create(z);I.prototype=k,f(_,"constructor",{value:k,configurable:!0}),f(k,"constructor",{value:I,configurable:!0}),I.displayName=b(k,C,"GeneratorFunction");function Y(t){["next","throw","return"].forEach(function(e){b(t,e,function(r){return this._invoke(e,r)})})}l.isGeneratorFunction=function(t){var e=typeof t=="function"&&t.constructor;return e?e===I||(e.displayName||e.name)==="GeneratorFunction":!1},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,b(t,C,"GeneratorFunction")),t.prototype=Object.create(_),t},l.awrap=function(t){return{__await:t}};function B(t,e){function r(p,E,L,P){var j=S(t[p],t,E);if(j.type==="throw")P(j.arg);else{var Q=j.arg,q=Q.value;return q&&typeof q=="object"&&i.call(q,"__await")?e.resolve(q.__await).then(function(T){r("next",T,L,P)},function(T){r("throw",T,L,P)}):e.resolve(q).then(function(T){Q.value=T,L(Q)},function(T){return r("throw",T,L,P)})}}var c;function n(p,E){function L(){return new e(function(P,j){r(p,E,P,j)})}return c=c?c.then(L,L):L()}f(this,"_invoke",{value:n})}Y(B.prototype),b(B.prototype,O,function(){return this}),l.AsyncIterator=B,l.async=function(t,e,r,c,n){n===void 0&&(n=Promise);var p=new B(M(t,e,r,c),n);return l.isGeneratorFunction(e)?p:p.next().then(function(E){return E.done?E.value:p.next()})};function Z(t,e,r){var c=R;return function(p,E){if(c===$)throw new Error("Generator is already running");if(c===N){if(p==="throw")throw E;return F()}for(r.method=p,r.arg=E;;){var L=r.delegate;if(L){var P=V(L,r);if(P){if(P===y)continue;return P}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(c===R)throw c=N,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);c=$;var j=S(t,e,r);if(j.type==="normal"){if(c=r.done?N:W,j.arg===y)continue;return{value:j.arg,done:r.done}}else j.type==="throw"&&(c=N,r.method="throw",r.arg=j.arg)}}}function V(t,e){var r=e.method,c=t.iterator[r];if(c===m)return e.delegate=null,r==="throw"&&t.iterator.return&&(e.method="return",e.arg=m,V(t,e),e.method==="throw")||r!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var n=S(c,t.iterator,e.arg);if(n.type==="throw")return e.method="throw",e.arg=n.arg,e.delegate=null,y;var p=n.arg;if(!p)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y;if(p.done)e[t.resultName]=p.value,e.next=t.nextLoc,e.method!=="return"&&(e.method="next",e.arg=m);else return p;return e.delegate=null,y}Y(_),b(_,C,"Generator"),b(_,h,function(){return this}),b(_,"toString",function(){return"[object Generator]"});function s(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function d(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function g(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(s,this),this.reset(!0)}l.keys=function(t){var e=Object(t),r=[];for(var c in e)r.push(c);return r.reverse(),function n(){for(;r.length;){var p=r.pop();if(p in e)return n.value=p,n.done=!1,n}return n.done=!0,n}};function w(t){if(t){var e=t[h];if(e)return e.call(t);if(typeof t.next=="function")return t;if(!isNaN(t.length)){var r=-1,c=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=m,n.done=!0,n};return c.next=c}}return{next:F}}l.values=w;function F(){return{value:m,done:!0}}return g.prototype={constructor:g,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(d),!t)for(var e in this)e.charAt(0)==="t"&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=m)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(P,j){return p.type="throw",p.arg=t,e.next=P,j&&(e.method="next",e.arg=m),!!j}for(var c=this.tryEntries.length-1;c>=0;--c){var n=this.tryEntries[c],p=n.completion;if(n.tryLoc==="root")return r("end");if(n.tryLoc<=this.prev){var E=i.call(n,"catchLoc"),L=i.call(n,"finallyLoc");if(E&&L){if(this.prev<n.catchLoc)return r(n.catchLoc,!0);if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else if(E){if(this.prev<n.catchLoc)return r(n.catchLoc,!0)}else if(L){if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r];if(c.tryLoc<=this.prev&&i.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var n=c;break}}n&&(t==="break"||t==="continue")&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var p=n?n.completion:{};return p.type=t,p.arg=e,n?(this.method="next",this.next=n.finallyLoc,y):this.complete(p)},complete:function(t,e){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),d(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var c=r.completion;if(c.type==="throw"){var n=c.arg;d(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:w(t),resultName:e,nextLoc:r},this.method==="next"&&(this.arg=m),y}},l}(o.exports);try{regeneratorRuntime=a}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}})(ae);var ce={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}},le=(o,a)=>{const l=o._malloc(a.length*Uint32Array.BYTES_PER_ELEMENT);return a.forEach((u,i)=>{const f=o.lengthBytesUTF8(u)+1,m=o._malloc(f);o.stringToUTF8(u,m,f),o.setValue(l+Uint32Array.BYTES_PER_ELEMENT*i,m,"i32")}),[a.length,l]};const fe="@ffmpeg/ffmpeg",ue="0.11.6",pe="FFmpeg WebAssembly version",de="src/index.js",me="src/index.d.ts",ge={example:"examples"},he={start:"node scripts/server.js","start:worker":"node scripts/worker-server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js","build:worker":"rimraf dist && webpack --config scripts/webpack.config.worker.prod.js",prepublishOnly:"npm run build",lint:"eslint src",wait:"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node node_modules/mocha/bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},ye={"./src/node/index.js":"./src/browser/index.js"},we={type:"git",url:"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},ve=["ffmpeg","WebAssembly","video"],be="Jerome Wu <jeromewus@gmail.com>",Fe="MIT",Ee={url:"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},Le={node:">=12.16.1"},je="https://github.com/ffmpegwasm/ffmpeg.wasm#readme",Oe={"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},Pe={"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.11.0","@types/emscripten":"^1.39.4","babel-eslint":"^10.1.0","babel-loader":"^8.1.0",chai:"^4.2.0",cors:"^2.8.5",eslint:"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1",express:"^4.17.1",mocha:"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0",webpack:"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"},re={name:fe,version:ue,description:pe,main:de,types:me,directories:ge,scripts:he,browser:ye,repository:we,keywords:ve,author:be,license:Fe,bugs:Ee,engines:Le,homepage:je,dependencies:Oe,devDependencies:Pe},Se=(typeof process<"u",`https://unpkg.com/@ffmpeg/core@${re.devDependencies["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`),ke={corePath:Se};let ee=!1,oe=()=>{};const Ce=o=>{ee=o},_e=o=>{oe=o},Re=(o,a)=>{oe({type:o,message:a}),ee&&console.log(`[${o}] ${a}`)};var A={logging:ee,setLogging:Ce,setCustomLogger:_e,log:Re};const $e=o=>`
createFFmpegCore is not defined. ffmpeg.wasm is unable to find createFFmpegCore after loading ffmpeg-core.js from ${o}. Use another URL when calling createFFmpeg():

const ffmpeg = createFFmpeg({
  corePath: 'http://localhost:3000/ffmpeg-core.js',
});
`;var te={CREATE_FFMPEG_CORE_IS_NOT_DEFINED:$e};const D=async(o,a)=>{A.log("info",`fetch ${o}`);const l=await(await fetch(o)).arrayBuffer();A.log("info",`${o} file size = ${l.byteLength} bytes`);const u=new Blob([l],{type:a}),i=URL.createObjectURL(u);return A.log("info",`${o} blob URL = ${i}`),i},Te=async({corePath:o,workerPath:a,wasmPath:l})=>{if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){if(typeof o!="string")throw Error("corePath should be a string!");const v=new URL(o,import.meta.url).href,h=await D(v,"application/javascript"),O=await D(l!==void 0?l:v.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),C=await D(a!==void 0?a:v.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(b=>{if(globalThis.importScripts(h),typeof createFFmpegCore>"u")throw Error(te.CREATE_FFMPEG_CORE_IS_NOT_DEFINED(v));A.log("info","ffmpeg-core.js script loaded"),b({createFFmpegCore,corePath:h,wasmPath:O,workerPath:C})}):(A.log("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:h,wasmPath:O,workerPath:C}))}if(typeof o!="string")throw Error("corePath should be a string!");const u=new URL(o,import.meta.url).href,i=await D(u,"application/javascript"),f=await D(l!==void 0?l:u.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),m=await D(a!==void 0?a:u.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(v=>{const h=document.createElement("script"),O=()=>{if(h.removeEventListener("load",O),typeof createFFmpegCore>"u")throw Error(te.CREATE_FFMPEG_CORE_IS_NOT_DEFINED(u));A.log("info","ffmpeg-core.js script loaded"),v({createFFmpegCore,corePath:i,wasmPath:f,workerPath:m})};h.src=i,h.type="text/javascript",h.addEventListener("load",O),document.getElementsByTagName("head")[0].appendChild(h)}):(A.log("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:i,wasmPath:f,workerPath:m}))},Ae=o=>new Promise((a,l)=>{const u=new FileReader;u.onload=()=>{a(u.result)},u.onerror=({target:{error:{code:i}}})=>{l(Error(`File could not be read! Code=${i}`))},u.readAsArrayBuffer(o)}),Ne=async o=>{let a=o;return typeof o>"u"?new Uint8Array:(typeof o=="string"?/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(o)?a=atob(o.split(",")[1]).split("").map(l=>l.charCodeAt(0)):a=await(await fetch(new URL(o,import.meta.url).href)).arrayBuffer():(o instanceof File||o instanceof Blob)&&(a=await Ae(o)),new Uint8Array(a))},Ge=Object.freeze(Object.defineProperty({__proto__:null,defaultOptions:ke,fetchFile:Ne,getCreateFFmpegCore:Te},Symbol.toStringTag,{value:"Module"})),ne=se(Ge),{defaultArgs:Ie,baseOptions:Ue}=ce,Be=le,{defaultOptions:De,getCreateFFmpegCore:Me}=ne,{version:We}=re,X=Error("ffmpeg.wasm is not ready, make sure you have completed load().");var ze=(o={})=>{const{log:a,logger:l,progress:u,...i}={...Ue,...De,...o};let f=null,m=null,v=null,h=null,O=!1,C=()=>{},b=a,M=u,S=0,R=0,W=!1,$=0;const N=s=>{s==="FFMPEG_END"&&v!==null&&(v(),v=null,h=null,O=!1)},y=(s,d)=>{C({type:s,message:d}),b&&console.log(`[${s}] ${d}`)},G=s=>{const[d,g,w]=s.split(":");return parseFloat(d)*60*60+parseFloat(g)*60+parseFloat(w)},I=(s,d)=>{if(typeof s=="string")if(s.startsWith("  Duration")){const g=s.split(", ")[0].split(": ")[1],w=G(g);d({duration:w,ratio:$}),(S===0||S>w)&&(S=w,W=!0)}else if(W&&s.startsWith("    Stream")){const g=s.match(/([\d.]+) fps/);if(g){const w=parseFloat(g[1]);R=S*w}else R=0;W=!1}else if(s.startsWith("frame")||s.startsWith("size")){const g=s.split("time=")[1].split(" ")[0],w=G(g),F=s.match(/frame=\s*(\d+)/);if(R&&F){const t=parseFloat(F[1]);$=Math.min(t/R,1)}else $=w/S;d({ratio:$,time:w})}else s.startsWith("video:")&&(d({ratio:1}),S=0)},k=({type:s,message:d})=>{y(s,d),I(d,M),N(d)},z=async()=>{if(y("info","load ffmpeg-core"),f===null){y("info","loading ffmpeg-core");const{createFFmpegCore:s,corePath:d,workerPath:g,wasmPath:w}=await Me(i);f=await s({mainScriptUrlOrBlob:d,printErr:F=>k({type:"fferr",message:F}),print:F=>k({type:"ffout",message:F}),locateFile:(F,t)=>{if(typeof window<"u"||typeof WorkerGlobalScope<"u"){if(typeof w<"u"&&F.endsWith("ffmpeg-core.wasm"))return w;if(typeof g<"u"&&F.endsWith("ffmpeg-core.worker.js"))return g}return t+F}}),m=f.cwrap(i.mainName||"proxy_main","number",["number","number"]),y("info","ffmpeg-core loaded")}else throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.")},x=()=>f!==null,U=(...s)=>{if(y("info",`run ffmpeg command: ${s.join(" ")}`),f===null)throw X;if(O)throw Error("ffmpeg.wasm can only run one command at a time");return O=!0,new Promise((d,g)=>{const w=[...Ie,...s].filter(F=>F.length!==0);v=d,h=g,m(...Be(f,w))})},_=(s,...d)=>{if(y("info",`run FS.${s} ${d.map(g=>typeof g=="string"?g:`<${g.length} bytes binary file>`).join(" ")}`),f===null)throw X;{let g=null;try{g=f.FS[s](...d)}catch{throw Error(s==="readdir"?`ffmpeg.FS('readdir', '${d[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:s==="readFile"?`ffmpeg.FS('readFile', '${d[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return g}},Y=()=>{if(f===null)throw X;h&&h("ffmpeg has exited"),O=!1;try{f.exit(1)}catch(s){y(s.message),h&&h(s)}finally{f=null,m=null,v=null,h=null}},B=s=>{M=s},Z=s=>{C=s},V=s=>{b=s};return y("info",`use ffmpeg.wasm v${We}`),{setProgress:B,setLogger:Z,setLogging:V,load:z,isLoaded:x,run:U,exit:Y,FS:_}};const xe=ze,{fetchFile:qe}=ne;var ie={createFFmpeg:xe,fetchFile:qe};const H=ie.createFFmpeg({log:!0}),J=document.getElementById("status"),K=document.getElementById("downloadLink");document.getElementById("resizeButton").addEventListener("click",async()=>{const o=document.getElementById("videoInput").files[0];if(console.log("Video input detected:",o),!o){alert("Please select a video file.");return}try{J.textContent="Loading FFmpeg...",console.log("Initializing FFmpeg...");const a=Date.now();await H.load(),console.log(`FFmpeg loaded successfully in ${Date.now()-a}ms`),J.textContent="Processing video...",console.log("Writing input file to virtual filesystem..."),H.FS("writeFile","input.mp4",await ie.fetchFile(o)),console.log("Input file written successfully."),console.log("Running FFmpeg command to resize video..."),await H.run("-i","input.mp4","-vf","scale=640:360","output.mp4"),console.log("FFmpeg command executed successfully."),console.log("Reading output file from virtual filesystem...");const l=H.FS("readFile","output.mp4");console.log("Output file read successfully. Preparing for download...");const u=new Blob([l.buffer],{type:"video/mp4"}),i=URL.createObjectURL(u);K.href=i,K.download="resized_video.mp4",K.style.display="block",K.textContent="Download Resized Video",J.textContent="Done!",console.log("Video resizing completed successfully.")}catch(a){console.error("Error during processing:",a),J.textContent="An error occurred during processing."}});
